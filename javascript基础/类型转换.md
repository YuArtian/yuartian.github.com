# 类型转换

> https://juejin.im/post/5e7d7670f265da797f4afa84
>
> https://juejin.im/post/5e8d3b5d6fb9a03c7204ce5c



# 原始类型相互转换

## 转布尔

Boolean()

只有 6 种值可以被转换成 false，其他都会被转换成 true

```js
console.log(Boolean()) // false
console.log(Boolean(false)) // false
console.log(Boolean(undefined)) // false
console.log(Boolean(null)) // false
console.log(Boolean(+0)) // false
console.log(Boolean(-0)) // false
console.log(Boolean(NaN)) // false
console.log(Boolean("")) // false
```

## 转数字/ToNumber

Number()

如果 Number 函数不传参数，返回 +0，如果有参数，调用 `ToNumber(value)`

ToNumber规则如下：

| 参数类型  | 结果                    |
| --------- | ----------------------- |
| Undefined | NAN                     |
| Null      | +0                      |
| Boolean   | true => 1 / false => +0 |
| Number    | 返回相等的值            |
| String    | 判断规则如下            |

如果通过 Number 转换函数传入一个字符串，它会试图将其转换成一个整数或浮点数，而且会忽略所有前导的 0

如果有一个字符不是数字，结果都会返回 NaN，鉴于这种严格的判断，我们一般还会使用更加灵活的 parseInt 和 parseFloat 进行转换

- parseInt 只解析整数
- parseFloat 则可以解析整数和浮点数

如果字符串前缀是 "0x" 或者"0X"，parseInt 将其解释为十六进制数，parseInt 和 parseFloat 都会跳过任意数量的前导空格，尽可能解析更多数值字符，并忽略后面的内容。如果第一个非空格字符是非法的数字直接量，将最终返回 NaN

## 转字符/ToString

String()

 `String` 函数不传参数，返回空字符串，如果有参数，调用 `ToString(value)`

| 参数类型  | 结果                                                    |
| --------- | ------------------------------------------------------- |
| Undefined | 'undefined'                                             |
| Null      | 'null'                                                  |
| Boolean   | 如果参数是 true，返回 "true" 参数为 false，返回 "false" |
| String    | 与之相等的字符串                                        |
| Number    | 转换为对应的字符串写法                                  |

## 转对象

原始值通过调用 String()、Number() 或者 Boolean() 构造函数，转换为它们各自的包装对象

null 和 undefined 属于例外，当将它们用在期望是一个对象的地方都会造成一个类型错误 (TypeError) 异常，而不会执行正常的转换



## toString

所有的对象除了 null 和 undefined 之外的任何值都具有 `toString` 方法

调用对象的 toString 方法时，其实调用的是 Object.prototype 上的 toString 方法

```js
Object.prototype.toString.call({a: 1}) // "[object Object]"
({a: 1}).toString() // "[object Object]"
({a: 1}).toString === Object.prototype.toString // true
```



JavaScript 下的很多类根据各自的特点，定义了更多版本的 toString 方法。例如:

1. 数组的 toString 方法将每个数组元素转换成一个字符串，并在元素之间添加逗号后合并成结果字符串
2. 函数的 toString 方法返回源代码字符串
3. 日期的 toString 方法返回一个可读的日期和时间字符串
4. RegExp 的 toString 方法返回一个表示正则表达式直接量的字符串

## valueOf

另一个转换对象的函数是 valueOf，表示对象的原始值

默认的 valueOf 方法返回这个对象本身，数组、函数、正则简单的继承了这个默认方法，也会返回对象本身。日期是一个例外，它会返回它的一个内容表示: 1970 年 1 月 1 日以来的毫秒数

## ToPrimitive

```js
ToPrimitive(input[, PreferredType])
```

第一个参数是 input，表示要处理的输入值

第二个参数是 PreferredType，非必填，表示希望转换成的类型，有两个值可以选，Number 或者 String

当不传入 PreferredType 时，如果 input 是日期类型，相当于传入 String，否则，都相当于传入 Number



- 如果传入的 input 是 Undefined、Null、Boolean、Number、String 类型，直接返回该值。

- 如果是 ToPrimitive(obj, Number)，处理步骤如下：
  1. 如果 obj 为 基本类型，直接返回
  2. 否则，调用 valueOf 方法，如果返回一个原始值，则 JavaScript 将其返回
  3. 否则，调用 toString 方法，如果返回一个原始值，则 JavaScript 将其返回
  4. 否则，JavaScript 抛出一个类型错误异常

- 如果是 ToPrimitive(obj, String)，处理步骤如下：
  1. 如果 obj为 基本类型，直接返回
  2. 否则，调用 toString 方法，如果返回一个原始值，则 JavaScript 将其返回
  3. 否则，调用 valueOf 方法，如果返回一个原始值，则 JavaScript 将其返回
  4. 否则，JavaScript 抛出一个类型错误异常